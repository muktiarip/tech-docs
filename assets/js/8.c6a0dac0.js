(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{354:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"bluetooth"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bluetooth"}},[t._v("#")]),t._v(" Bluetooth")]),t._v(" "),a("h2",{attrs:{id:"bluetooth-receive-pairing-request-without-gui"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bluetooth-receive-pairing-request-without-gui"}},[t._v("#")]),t._v(" Bluetooth Receive Pairing Request without GUI")]),t._v(" "),a("p",[t._v("The bluetoothctl daemon deals with incoming pairing request, scanning etc and\nthe same are made by the Bluetooth GUI. If you remove from the GUI the\nBluetooth stuff (right click on the icon and then remove) and then open a\nterminal and run:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("bluetoothctl\nagent NoInputNoOutput\n")])])]),a("p",[t._v("incoming pairing request will be automatically accepted.")]),t._v(" "),a("p",[t._v("As countercheck, before removing your Bluetooth GUI if you run the\naforementioned commands without accepting on the pop-up dialog you should see\nPaired: yes in the log.")]),t._v(" "),a("h2",{attrs:{id:"bluetooth-pairing-in-raspberry-pi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bluetooth-pairing-in-raspberry-pi"}},[t._v("#")]),t._v(" Bluetooth Pairing In Raspberry Pi")]),t._v(" "),a("p",[t._v("Since bluetooth-agent command doesn't exist on Jessie, the modern way is to\npipe relevant commands to bluetoothctl. Based on this SO question, the\nfollowing script should enable automatic pairing without manual pin entry:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" bluetoothctl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("EOF\npower on\ndiscoverable on\npairable on\nagent NoInputNoOutput\ndefault-agent \nEOF")]),t._v("\n")])])]),a("h2",{attrs:{id:"bluetooth-accepting-pairing-request-with-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bluetooth-accepting-pairing-request-with-cli"}},[t._v("#")]),t._v(" Bluetooth Accepting Pairing Request with CLI")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("hciconfig hci0 up\nhciconfig hci0 sspmode "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nhciconfig hci0 piscan\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" bluetooth-agent "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1234")]),t._v("\n")])])]),a("ul",[a("li",[a("a",{attrs:{href:"https://www.kynetics.com/docs/2018/pairing_agents_bluez/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference1"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://raspberrypi.stackexchange.com/questions/50496/automatically-accept-bluetooth-pairings",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference2"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.raspberrypi.org/forums/viewtopic.php?p=955425#p955425",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference3"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/DrRowland/RPi-Bluetooth-Console",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference4"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" hciconfig hci0 up\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" hciconfig hci0 piscan\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mknod")]),t._v(" -m "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("666")]),t._v(" /dev/rfcomm0 c "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("216")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" rfcomm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),t._v(" /dev/rfcomm0 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /dev/rfcomm0\n")])])]),a("h2",{attrs:{id:"ble-get-notification-in-shell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ble-get-notification-in-shell"}},[t._v("#")]),t._v(" BLE - Get Notification In Shell")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" hcitool lescan\n$"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gatttool -I -b "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${BT_ADDRESS}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" connect\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Show services. Note attr handle (start and end)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" primary\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# We are interested in a service with handle 0x0028 through 0x002b")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Discover characteristic descriptors. Note for UUID 2902 (notification)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" char-desc "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(" 2b\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# We got handle 0x002b for UUID 2902")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enable notification")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" char-write-req 2b 0100\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disable notification")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" char-write-req 2b 0000\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" disconnect\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])]),a("h2",{attrs:{id:"python-code-for-bluetooth-thermal-printer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python-code-for-bluetooth-thermal-printer"}},[t._v("#")]),t._v(" Python Code For Bluetooth Thermal Printer")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bluetooth "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n\n_uuid "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"00001101-0000-1000-8000-00102345678"')]),t._v("\n_addr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8C:De:DA:52:C4:CE"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'escpos-payload.bin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rb'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nsm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" find_service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uuid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("_uuid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" address"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("_addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sm -> [{'service-classes': ['1101'], 'profiles': [('1101', 256)], 'name': 'SerialPort', 'description': None, 'provider': None, 'service-id': None, 'protocol': 'RFCOMM', 'port': 6, 'host': '8C:De:52:DA:CE:C4'}]")]),t._v("\n_host "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'host'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n_port "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'port'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nsock "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BluetoothSocket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RFCOMM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"cli-bluetooth-pairing-rpi-headless"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cli-bluetooth-pairing-rpi-headless"}},[t._v("#")]),t._v(" CLI Bluetooth Pairing (RPi Headless)")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start bluetooth\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" bluetoothctl\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#BluetoothCtl> scan")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#BluetoothCtl> pair 12:34:56:78:90:ab")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#BluetoothCtl> quit")]),t._v("\n")])])]),a("h2",{attrs:{id:"bluetooth-serial-port-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bluetooth-serial-port-server"}},[t._v("#")]),t._v(" Bluetooth serial port server:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sdptool add --channel=3 SP")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#rfcomm listen /dev/rfcomm0 3")]),t._v("\n")])])]),a("p",[t._v("Don't use channel 1! It wont work.")]),t._v(" "),a("h2",{attrs:{id:"misc-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#misc-1"}},[t._v("#")]),t._v(" Misc 1")]),t._v(" "),a("p",[t._v("BLE Beacon problems?\nhttps://www.brooklynmuseum.org/community/blogosphere/2015/02/04/the-realities-of-installing-ibeacon-to-scale/")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" hcitool -i hci0 cmd 0x08 0x0006 a0 00 a0 00 03 00 00 00 00 00 00 00 00 07 00\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" hcitool -i hci0 cmd 0x08 0x0008 1E 02 01 1A 1A FF 4C 00 02 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" FB 0B "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("57")]),t._v(" A2 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("82")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("44")]),t._v(" CD "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("91")]),t._v(" 3A "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("94")]),t._v(" A1 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" BA "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(" 06 00 01 00 02 D1 00\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" hcitool -i hci0 cmd 0x08 0x000a 01\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);